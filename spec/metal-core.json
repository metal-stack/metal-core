{
  "swagger": "2.0",
  "info": {
    "description": "Resource for managing PXE clients",
    "title": "metal-core",
    "contact": {
      "name": "Devops Team",
      "url": "http://www.f-i-ts.de",
      "email": "devops@f-i-ts.de"
    },
    "license": {
      "name": "MIT",
      "url": "http://mit.org"
    },
    "version": "1.0.0"
  },
  "paths": {
    "/machine/install/{id}": {
      "get": {
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "tags": [
          "machine"
        ],
        "summary": "install machine by ID",
        "operationId": "Install",
        "parameters": [
          {
            "type": "string",
            "description": "identifier of the machine",
            "name": "id",
            "in": "path",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/models.MetalMachineWithPhoneHomeToken"
            }
          },
          "304": {
            "description": "No allocation"
          },
          "404": {
            "description": "Not Found"
          },
          "417": {
            "description": "Incomplete machine"
          },
          "500": {
            "description": "Error"
          },
          "default": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/models.MetalMachineWithPhoneHomeToken"
            }
          }
        }
      }
    },
    "/machine/register/{id}": {
      "post": {
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "tags": [
          "machine"
        ],
        "summary": "register machine by ID",
        "operationId": "Register",
        "parameters": [
          {
            "type": "string",
            "description": "identifier of the machine",
            "name": "id",
            "in": "path",
            "required": true
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/domain.MetalHammerRegisterMachineRequest"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/models.MetalMachine"
            }
          },
          "400": {
            "description": "Bad request"
          },
          "500": {
            "description": "Error"
          },
          "default": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/models.MetalMachine"
            }
          }
        }
      }
    },
    "/machine/report/{id}": {
      "post": {
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "tags": [
          "machine"
        ],
        "summary": "report machine by ID",
        "operationId": "Report",
        "parameters": [
          {
            "type": "string",
            "description": "identifier of the machine",
            "name": "id",
            "in": "path",
            "required": true
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/domain.Report"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/models.MetalMachine"
            }
          },
          "406": {
            "description": "Not acceptable"
          },
          "500": {
            "description": "Error"
          },
          "default": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/models.MetalMachine"
            }
          }
        }
      }
    },
    "/machine/{id}/event": {
      "post": {
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "tags": [
          "machine"
        ],
        "summary": "adds a machine provisioning event",
        "operationId": "AddProvisioningEvent",
        "parameters": [
          {
            "type": "string",
            "description": "identifier of the machine",
            "name": "id",
            "in": "path",
            "required": true
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/models.MetalProvisioningEvent"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "404": {
            "description": "Not Found"
          },
          "default": {
            "description": "OK"
          }
        }
      }
    },
    "/v1/boot/{mac}": {
      "get": {
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "tags": [
          "boot"
        ],
        "summary": "boot machine by mac",
        "operationId": "Boot",
        "parameters": [
          {
            "type": "string",
            "description": "mac of a network interface of the machine",
            "name": "mac",
            "in": "path",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/domain.BootResponse"
            }
          },
          "202": {
            "description": "Accepted",
            "schema": {
              "$ref": "#/definitions/domain.BootResponse"
            }
          },
          "400": {
            "description": "Bad request",
            "schema": {
              "$ref": "#/definitions/domain.BootResponse"
            }
          },
          "default": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/domain.BootResponse"
            }
          }
        }
      }
    }
  },
  "definitions": {
    "domain.BootResponse": {
      "required": [
        "initrd"
      ],
      "properties": {
        "cmdline": {
          "type": "string"
        },
        "initrd": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "kernel": {
          "type": "string"
        }
      }
    },
    "domain.MetalHammerRegisterMachineRequest": {
      "required": [
        "cpu_cores",
        "disks",
        "memory",
        "nics",
        "ipmi"
      ],
      "properties": {
        "cpu_cores": {
          "type": "integer",
          "format": "int32"
        },
        "disks": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/models.MetalBlockDevice"
          }
        },
        "ipmi": {
          "description": "the IPMI connection configuration",
          "$ref": "#/definitions/models.MetalIPMI"
        },
        "memory": {
          "type": "integer",
          "format": "int64"
        },
        "nics": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/models.MetalNic"
          }
        },
        "uuid": {
          "description": "the uuid of the machine to register",
          "type": "string"
        }
      }
    },
    "domain.Report": {
      "required": [
        "message",
        "console_password"
      ],
      "properties": {
        "console_password": {
          "description": "the console password which was generated while provisioning",
          "type": "string"
        },
        "message": {
          "description": "if installation failed, the error message",
          "type": "string"
        },
        "success": {
          "description": "true if installation succeeded",
          "type": "boolean"
        }
      }
    },
    "models.MetalBlockDevice": {
      "required": [
        "name",
        "size"
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "size": {
          "type": "integer",
          "format": "int64"
        }
      }
    },
    "models.MetalBootConfiguration": {
      "required": [
        "commandline",
        "imageurl",
        "kernelurl"
      ],
      "properties": {
        "commandline": {
          "type": "string"
        },
        "imageurl": {
          "type": "string"
        },
        "kernelurl": {
          "type": "string"
        }
      }
    },
    "models.MetalConstraint": {
      "required": [
        "max",
        "min",
        "type"
      ],
      "properties": {
        "max": {
          "type": "integer",
          "format": "int64"
        },
        "min": {
          "type": "integer",
          "format": "int64"
        },
        "type": {
          "type": "string"
        }
      }
    },
    "models.MetalFru": {
      "properties": {
        "board_mfg": {
          "type": "string"
        },
        "board_mfg_serial": {
          "type": "string"
        },
        "board_part_number": {
          "type": "string"
        },
        "chassis_part_number": {
          "type": "string"
        },
        "chassis_part_serial": {
          "type": "string"
        },
        "product_manufacturer": {
          "type": "string"
        },
        "product_part_number": {
          "type": "string"
        },
        "product_serial": {
          "type": "string"
        }
      }
    },
    "models.MetalIPMI": {
      "required": [
        "address",
        "fru",
        "interface",
        "mac",
        "password",
        "user"
      ],
      "properties": {
        "address": {
          "type": "string"
        },
        "fru": {
          "$ref": "#/definitions/models.MetalFru"
        },
        "interface": {
          "type": "string"
        },
        "mac": {
          "type": "string"
        },
        "password": {
          "type": "string"
        },
        "user": {
          "type": "string"
        }
      }
    },
    "models.MetalImage": {
      "required": [
        "id",
        "url"
      ],
      "properties": {
        "changed": {
          "type": "string"
        },
        "created": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "url": {
          "type": "string"
        }
      }
    },
    "models.MetalMachine": {
      "required": [
        "allocation",
        "events",
        "hardware",
        "id",
        "liveliness",
        "partition",
        "rackid",
        "size",
        "state",
        "tags"
      ],
      "properties": {
        "allocation": {
          "$ref": "#/definitions/models.MetalMachineAllocation"
        },
        "changed": {
          "type": "string"
        },
        "created": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "events": {
          "$ref": "#/definitions/models.MetalRecentProvisioningEvents"
        },
        "hardware": {
          "$ref": "#/definitions/models.MetalMachineHardware"
        },
        "id": {
          "type": "string"
        },
        "liveliness": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "partition": {
          "$ref": "#/definitions/models.MetalPartition"
        },
        "rackid": {
          "type": "string"
        },
        "size": {
          "$ref": "#/definitions/models.MetalSize"
        },
        "state": {
          "$ref": "#/definitions/models.MetalMachineState"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "models.MetalMachineAllocation": {
      "required": [
        "cidr",
        "created",
        "hostname",
        "name",
        "project",
        "ssh_pub_keys",
        "tenant",
        "vrf"
      ],
      "properties": {
        "cidr": {
          "type": "string"
        },
        "console_password": {
          "type": "string"
        },
        "created": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "hostname": {
          "type": "string"
        },
        "image": {
          "$ref": "#/definitions/models.MetalImage"
        },
        "last_ping": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "project": {
          "type": "string"
        },
        "ssh_pub_keys": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "tenant": {
          "type": "string"
        },
        "user_data": {
          "type": "string"
        },
        "vrf": {
          "type": "integer",
          "format": "int64"
        }
      }
    },
    "models.MetalMachineHardware": {
      "required": [
        "cpu_cores",
        "disks",
        "memory",
        "nics"
      ],
      "properties": {
        "cpu_cores": {
          "type": "integer",
          "format": "int32"
        },
        "disks": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/models.MetalBlockDevice"
          }
        },
        "memory": {
          "type": "integer",
          "format": "int64"
        },
        "nics": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/models.MetalNic"
          }
        }
      }
    },
    "models.MetalMachineState": {
      "required": [
        "description",
        "value"
      ],
      "properties": {
        "description": {
          "type": "string"
        },
        "value": {
          "type": "string"
        }
      }
    },
    "models.MetalMachineWithPhoneHomeToken": {
      "required": [
        "machine",
        "phone_home_token"
      ],
      "properties": {
        "machine": {
          "$ref": "#/definitions/models.MetalMachine"
        },
        "phone_home_token": {
          "type": "string"
        }
      }
    },
    "models.MetalNic": {
      "required": [
        "mac",
        "name",
        "neighbors"
      ],
      "properties": {
        "mac": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "neighbors": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/models.MetalNic"
          }
        },
        "vrf": {
          "type": "string"
        }
      }
    },
    "models.MetalPartition": {
      "required": [
        "bootconfig",
        "id"
      ],
      "properties": {
        "bootconfig": {
          "$ref": "#/definitions/models.MetalBootConfiguration"
        },
        "changed": {
          "type": "string"
        },
        "created": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        }
      }
    },
    "models.MetalProvisioningEvent": {
      "required": [
        "event"
      ],
      "properties": {
        "event": {
          "type": "string"
        },
        "message": {
          "type": "string"
        },
        "time": {
          "type": "string"
        }
      }
    },
    "models.MetalRecentProvisioningEvents": {
      "required": [
        "incomplete_provisioning_cycles",
        "last_event_time",
        "log"
      ],
      "properties": {
        "incomplete_provisioning_cycles": {
          "type": "string"
        },
        "last_event_time": {
          "type": "string"
        },
        "log": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/models.MetalProvisioningEvent"
          }
        }
      }
    },
    "models.MetalSize": {
      "required": [
        "constraints",
        "id"
      ],
      "properties": {
        "changed": {
          "type": "string"
        },
        "constraints": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/models.MetalConstraint"
          }
        },
        "created": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        }
      }
    }
  },
  "tags": [
    {
      "description": "Booting PXE clients",
      "name": "boot"
    },
    {
      "description": "Managing PXE boot clients",
      "name": "machine"
    }
  ]
}